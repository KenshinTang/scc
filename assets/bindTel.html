<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1.0,user-scalable=no" name="viewport">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no,email=no,adress=no" />

    <title>绑定手机号</title>

    <link rel="stylesheet" href="css/g.css">
    <link rel="stylesheet" href="css/comm.css">

    <style>
        .getCode {
            border: 1px solid #E30008;
            color: #E30008;
            border-radius: 3px;
            padding: 5px 10px;
            text-align: center;
        }

        .submit {
            margin: 100px 10px;
        }
    </style>

</head>

<!--******************************************************************************-->

<body>

    <header>
        <div class="navBar">
            <div class="navBackIcon" onclick="Comm.close()"></div>
            <div class="navTitle">绑定手机号</div>
        </div>
    </header>
    <!--******************************************************************************-->

    <section class="bg_lgray">

        <div class="topCt paddt30 paddb30 paddl20 paddr20 lh20 f16">
            <div class="col_sub">输入新的手机号:</div>
        </div>


        <div class="bg_white flex_between p10 bottomBorder pl15">
            <div class="flex_start">
                <div class="baseWH">
                    <img src="img/login/tel_mine.png" height="20" alt="">
                </div>
                <input id="phone" type="tel" placeholder="请输入11位手机号" class="marg_h5 f15 lh40" name="newPhone" data-reg='m'
                    maxlength="11">
            </div>
        </div>

        <div class="bg_white flex_between p10 pl15">
            <div class="flex_start">
                <div class="baseWH">
                    <img src="img/Invitation/yazma.png" width="20" alt="">
                </div>

                <input type="tel" placeholder="请输入验证码" name="code" data-reg='c' class="marg_h5 f15 lh40" maxlength="4">
            </div>
            <button id="yzm" class="getCode" style="background-color:#FFFFFF" onclick="model.yzm(this);">获取验证码</button>
        </div>



        <div class="submit bg_trans col_white f18 lh50 center br5" onclick="model.next()">完成</div>


    </section>

    <!--******************************************************************************-->
    <footer></footer>

    <script src="js/z.js"></script>
    <script src="js/g.js"></script>
    <script src="js/comm.js"></script>
    <script src="js/api.js"></script>

    <script>
        function pageload() {

        }
        var model = {
            o: {},
            u: Comm.db('userinfo'),
            next: function () {
                var opt = Check.submit('POST');
                if (opt) {
                    AJAX.POST('/common/customer/modifyPhone', opt, function (a) {
                        if (a.code == 1) {
                            Comm.message('保存成功');
                            setTimeout(function () {
                                Comm.gotop()
                            }, 300);
                        } else {
                            Comm.message(a.msg);
                        }
                    });
                }
            },

            yzm: function (a) {
                if ($('#phone').val() == '') {
                    Comm.message('请输入新手机号');
                    return;
                }
                var time = 60;
                settime();
                this.getCode(a, 1);
                Comm.message('验证码已发送!');

                function settime() {
                    var yzm = $("#yzm");
                    if (time == 0) {
                        yzm.text("获取验证码");
                        yzm.css("background-color", "#FFFFFF");
                        yzm.css("border-color", "#E30008");
                        yzm.css("color", "#E30008");
                        yzm.removeAttr("disabled");
                        return;
                    } else {
                        yzm.removeClass("bg_trans");
                        yzm.text(time + "S重新发送");
                        yzm.css("background-color", "#EDEDED");
                        yzm.css("border-color", "#EDEDED");
                        yzm.css("color", "#B3B3B3");
                        yzm.attr("disabled", "disabled");
                        time--;
                    }
                    setTimeout(function () {
                        settime()
                    }, 1000)
                }
            },
            //获取验证码
            getCode: function (t) {
                this.o.type = 1; //1：注册 2：找回密码  5：手机验证
                this.o.phone = this.u.phone;
                AJAX.POST('/common/sms/send', this.o, function (a) {

                });
            }
        }
    </script>

</body>

</html>