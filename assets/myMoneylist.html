<!DOCTYPE html>

<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta content="width=device-width,initial-scale=1.0,user-scalable=no" name="viewport">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no,email=no,adress=no" />
    <title>余额明细</title>
    <link rel="stylesheet" href="css/g.css">
    <link rel="stylesheet" href="css/comm.css">
    <link rel="stylesheet" href="inc/mescroll/mescroll.min.css">
    <style>
        .navItemIcon {
            background-image: url('img/tbshop/Search.png');
            background-size: 20px;
        }

        .moneyRed {
            color: #E30008;
        }

        .color999 {
            margin-top: 5px;
        }

        #sinbox {
            width: 100%;
            position: absolute;
            top: 0px;
            left: 0px;
            padding: 0px;
            background-color: white;
        }

        #sinbox .item {
            /*padding: 0px 10px;*/
            line-height: 40px;
        }

        #sinbox .item span.btn {
            background: inherit;
            padding: 5px 20px;
            border-radius: 3px;
            color: #222;
            border: 1px solid #EBEBEB;
            font-size: 14px;
            margin-right: 15px;
        }

        #sinbox .item span.btnp {
            padding: 5px 15px;
        }

        #sinbox .item span.cur {
            color: #E30008;
            background-color: #FFEBEB;
            border-color: #E30008;
        }

        .bg_lred {
            background-color: #FFEBEB;
        }

        #sinbox .tb {
            height: 50px;
            line-height: 50px;
        }

        #sinbox .tb .td {
            width: 50%;
            float: left;
            background-color: #FFEBEB;
            color: #E30008;
        }

        #sinbox .tb .r {
            width: 50%;
            height: 50px;
            float: left;
            color: #fff;
            border-radius: 0px;
        }

        #sinbox .item .scoll {
            overflow: hidden;
            overflow-x: auto;
            white-space: nowrap;
            text-align: left;
        }

        #sinbox .item input {
            width: 100px;
        }

        #MainBg,
        #WTDBOX {
            top: 64px;
            z-index: 99;
        }

        .calendar {
            background: url("img/tbmine/calend.png") center center no-repeat;
            background-size: 15px;
        }

        .lh35 {
            line-height: 35px;
        }

        .timeChooseItem {
            border-bottom: 1px solid #E30008;
            color: #E30008;
            padding-bottom: 5px;
            font-size: 14px;
        }

        .cellContent {
            padding: 18px 0px;
            padding-right: 15px;
        }
    </style>
</head>

<body>
    <header class="bg_white">
        <div class="navBar">
            <div class="navBackIcon" onclick="Comm.close()"></div>
            <div class="navItemIcon marr10" onclick="ttop();"></div>
            <div class="navTitle">余额明细</div>
        </div>
    </header>
    <section class="body mescroll" id="box">

        <!--  mask -->
        <div id="sinbox" wtd="sinboxTemp">
            <div class="item p20 clearfix">
                <div class="colorb5 left">选择类型：</div>
                <div class="scoll scollone" id="sco">
                </div>
            </div>
            <div class="item p20 pt10">
                <div class="colorb5 left">时间筛选：</div>
                <div class="tleft">
                    <input readonly id="start" placeholder="开始时间" onclick="datePickerstart.show();"
                        class="baseH center timeChooseItem" />
                    <span>&nbsp;至&nbsp;</span>
                    <input id="end" readonly onclick="datePickerend.show();" placeholder="结束时间"
                        class="baseH center timeChooseItem" />
                </div>
            </div>


            <div class="tb">
                <div class="td f18 bg_lred" onclick="reg()">重置</div>
                <div class="td f18 r btn bg_trans" onclick="okref()">确定</div>
            </div>
        </div>


        <div class="paddl15 paddr15 bg_lgray">
            <div class="bg_lgray lh35 flex_between">
                <div class="col_title">全部</div>
                <div class="baseWH calendar" onclick="ttop();"></div>
            </div>
            <!--<div class="lh40" id="time">-->
            <!--2018-9-9&nbsp;至&nbsp;2089-9-9&nbsp;提成收入-->
            <!--</div>-->
        </div>
        <div id="list">


            <!--<div class="paddl15 bg_white ">-->
            <!--<div class="cellContent bottomBorder">-->
            <!--<div class="label f16 icon_pre icon_phone ">-->
            <!--<p class="bold">消费让利-航利中心店</p>-->
            <!--<p class="f12 color999">2019-06-13  14:00:00</p>-->
            <!--</div>-->
            <!--<span class="moneyRed f18 bold">+100</span>-->
            <!--</div>-->
            <!--</div>-->

            <!--<div class="paddl15 bg_white ">-->
            <!--<div class="cellContent bottomBorder">-->
            <!--<div class="label f16 icon_pre icon_phone ">-->
            <!--<p>消费让利-航利中心店</p>-->
            <!--<p class="f12 color999">2019-06-13  14:00:00</p>-->
            <!--</div>-->

            <!--<span class="f18 bold">-100</span>-->
            <!--</div>-->
            <!--</div>-->

        </div>

    </section>

</body>


<script type="text/html" id="listTpl">
    {{each $data model i}}
    <div class="paddl15 bg_white ">
        <div class="cellContent bottomBorder">
            <div class="label f16 icon_pre icon_phone ">
                <p class="bold">{{fromType(model.actType)}}{{if model.actType==8}}{{if model.state==1}}(审核中){{/if}}{{if model.state==2}}(审核通过){{/if}}{{if model.state==3}}(审核失败){{/if}}{{/if}}</p>
                <p class="f12 color999">{{formatDate(model.addTime,'Y-m-d H:i')}}</p>
            </div>
            <span class="moneyRed f18 bold">{{getSymbol(model.consumeAct)}} {{priceTp(model.money)}}</span>
        </div>
    </div>
    {{/each}}
</script>
<script type="text/javascript" src="js/z.js"></script>
<script type="text/javascript" src="js/g.js"></script>
<script type="text/javascript" src="js/comm.js"></script>
<script type="text/javascript" src="inc/mescroll/mescroll.min.js"></script>
<script type="text/javascript" src="js/art-template.js"></script>
<script type="text/javascript" src="js/dict.js"></script>
<script type="text/javascript" src="js/picker.min.js"></script>
<script>
    var userinfo = Comm.db("userinfo");
    var datePickerstart, datePickerend, coinType = [],filterParms = {};


    function pageload() {
        initPicker();
        getType();
        model.search();
    }


    function initPicker() {
        datePickerstart = new Datepicker("开始时间", function (a, b, c) {
            $("#WTDBOX #start").val(b);
            filterParms.beginTime = b;
        });
        datePickerend = new Datepicker("结束时间", function (a, b, c) {
            $("#WTDBOX #end").val(b);
            filterParms.endTime = b;
        });
    }


    //填充筛选弹框的类型
    function getType() {
        var a = {};
        var data = [{
            coinface: '',
            coinname: '分润',
            type: 12,
        }, {
            coinface: '',
            coinname: '提现',
            type: 8,
        }, {
            coinface: '',
            coinname: '消费',
            type: 100,
        }]
        a.data = data;
        coinType = a.data;
        for (var i = 0; i < a.data.length; i++) {
            $("#sco").append('<span id="_cointypeid' + a.data[i].type +
                '" class="btn marr5"  onclick="scollclick(this,' + a.data[i].type + ')">' + a.data[i].coinname +
                '</span>')
        }
    }

    var model = {
        data: {
            consumeType: 1,
            receiverType: 4,
            receiverId: userinfo.customerId,
        },
        search: function () {
            if (!model.mere) {
                model.mere = new MERefresh('box,list', {
                    pagesize: 10,
                    refreshUrl: '/api/concumelog/getconcumelogList',
                    refreshTypeGet: true
                });
                model.mere.refreshOption.refreshParm = model.data;
                //页面 <刷新> 的回调
                model.mere.refreshOption.refresh_cb = function (refresh, d) {
                    var list = d.data || [];
                    refresh.successEndRef(list.length||0, d.totalCount||0);
                    var h = template('listTpl', d.data);
                    refresh.appendHtml(h);
                };
            } else {
                model.mere.refreshOption.refreshParm = model.data;
                //重置列表数据
                model.mere.MeRefScroll.resetUpScroll();
                //model.mere.MeRefScroll.triggerDownScroll();
                //隐藏回到顶部按钮
                model.mere.MeRefScroll.hideTopBtn();
            }
        }
    }

    //点击弹框确定
    function okref() {
        Comm.showWindow();
        var parms = app.assign(filterParms,model.data);
        // debugAlert(parms);
        // return;
        Comm.db('requestModel', parms);
        Comm.go('searchMoneyListResult.html');
        return;
    }

    //点击弹框重置
    function reg() {
        $("#WTDBOX #start").val("");
        $("#WTDBOX #end").val("");
        filterParms.beginTime = '';
        filterParms.endTime = '';
        scollclick("#btnone", '')
    }


    //点击search按钮
    function ttop() {
        Comm.showWindow('sinboxTemp', true);
        $("#MainBg,#WTDBOX").css("top", $(".navBar").height());
        $("#WTDBOX #start").val(filterParms.beginTime)
        $("#WTDBOX #end").val(filterParms.endTime);

        scollclick("#_cointypeid" + filterParms.selectType, filterParms.selectType)
    }


    //点击分润、提现、消费。。筛选
    function scollclick(a, id) {
        if (!$("#WTDBOX").find(a).hasClass("cur")) {
            $("#WTDBOX .scollone span").removeClass("cur")
            $("#WTDBOX").find(a).addClass("cur")
        }
        filterParms.selectType = id;
        filterParms.consumeAct = '';
        filterParms.actType = '';
        if (id == 100) {
            filterParms.consumeAct = 1;
        } else {
            filterParms.actType = id;
        }
    }
</script>

</html>